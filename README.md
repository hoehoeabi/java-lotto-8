# java-lotto-precourse
------------------------------------------------
# 요구사항 
```
간단한 로또 발매기를 구현한다.

로또 번호의 숫자 범위는 1~45까지이다.
1개의 로또를 발행할 때 중복되지 않는 6개의 숫자를 뽑는다.
당첨 번호 추첨 시 중복되지 않는 숫자 6개와 보너스 번호 1개를 뽑는다.
당첨은 1등부터 5등까지 있다. 당첨 기준과 금액은 아래와 같다.
1등: 6개 번호 일치 / 2,000,000,000원
2등: 5개 번호 + 보너스 번호 일치 / 30,000,000원
3등: 5개 번호 일치 / 1,500,000원
4등: 4개 번호 일치 / 50,000원
5등: 3개 번호 일치 / 5,000원
로또 구입 금액을 입력하면 구입 금액에 해당하는 만큼 로또를 발행해야 한다.
로또 1장의 가격은 1,000원이다.
당첨 번호와 보너스 번호를 입력받는다.
사용자가 구매한 로또 번호와 당첨 번호를 비교하여 당첨 내역 및 수익률을 출력하고 로또 게임을 종료한다.
사용자가 잘못된 값을 입력할 경우 IllegalArgumentException을 발생시키고, "[ERROR]"로 시작하는 에러 메시지를 출력 후 그 부분부터 입력을 다시 받는다.
Exception이 아닌 IllegalArgumentException, IllegalStateException 등과 같은 명확한 유형을 처리한다.
```
------------------------------------------------
# 구현 목록
1. 구입금액을 입력 받습니다.
2. 로또 구매 개수를 구한뒤 해당 개수만큼 로또 번호를 무작위로 뽑아줍니다.
3. 당첨번호를 입력받습니다.
4. 보너스 번호를 입력받습니다.
5. 당첨통계를 보여줍니다.
6. 수익률을 보여줍니다.

------------------------------------------------
# 예외 목록
- 구입금액은 1000원 단위여야합니다.
- 구입 금액과 보너스 숫자는 숫자로 파싱이 되어야합니다.
- 구입 금액과 보너스 숫자는 0이면 안됩니다.
- 로또 당첨 번호는 중복될 수 없습니다.
- 로또 당첨번호는 6개의 숫자와 5개의 `,`이여야 하며 ^(\d+,){5}\d+$의 형태여야합니다.
- 보너스 숫자는 로또 번호와 같을 수 없습니다.
------------------------------------------------
# 패키지 구조 
```
├── main  
│    └── java  
│       └── lotto  
│           ├── Application.java  
│           ├── config  
│           │   ├── AppConfig.java # 의존성 주입  
│           │   └── LottoConstants.java # 게임 규칙들이 상수로 정의되어있는 유틸클래스  
│           ├── controller  
│           │   ├── LottoController.java  
│           │   └── view  
│           │       └── LottoView.java  
│           ├── domain  
│           │   ├── Lotto.java  
│           │   └── LottoRank.java # 로또 등수 열거형 클래스  
│           ├── message # 예외,뷰에서 사용할 문자열이 있는 유틸클래스  
│           │   ├── ErrorMessage.java  
│           │   ├── InputMessage.java  
│           │   └── OutputMessage.java  
│           ├── repository  
│           │   └── LottoRepository.java  
│           ├── service  
│           │   └── LottoService.java  
│           ├── util  
│           │   └── calculator  
│           │       ├── LottoResultCalculator.java  
│           │       └── RateOfReturnCalculator.java  
│           └── validate  
│               └── Validators.java  
└── test  
    └── java  
        └── lotto  
            ├── ApplicationTest.java  
            ├── LottoTest.java  
            ├── service  
            │   └── LottoServiceTest.java  
            ├── util  
            │   └── calculator  
            │       ├── LottoResultCalculatorTest.java  
            │       └── RateOfReturnCalculatorTest.java  
            └── validate  
                └── ValidatorsTest.java
```
------------------------------------------------
# 구현 중 고민 했던 점, 막혔던 점, 새로 배운점

## 과도한 인터페이스(뷰)
일단 2주차 코드리뷰를 받으며 생긴 고민이었습니다(이전부터 뭔가 불편했었는데 크게 불편하진 않아 넘어갔었으나 리뷰를 받고 진지하게 생각해보았습니다)
사용자에게 입력을 받던 출력만을 담당하던 
궁극적으론 사용자에게 무언갈 보여주는 책임이 있다고 생각을 했고 
InputView,OutPutView 두 인터페이스를 상속받는 LottoView 인터페이스를 선언해두었습니다.(2주차도 같은 방식으로 하였습니다.)
허나 당장 테스트를 하지도 않고 추후 바뀔 가능성도 없는데 이렇게까지 해야하나 고민하였습니다.
확장 가능성도 없고 테스트도 안할거니 필요 없겠다 생각해서 인터페이스를 삭제했습니다.

## enum
enum을 어디서 사용해야 하나 처음엔 생각이 안났습니다.  
일단 구현해나가면서 보너스 번호를 입력받는 부분까진 매끄럽게 구현이 되었으나 당첨통계를 계산하는 부분에서 막혔었습니다.  
로또 당첨 등수밖에 enum으로 만들만한게 없어서  LottoRank를 만들었습니다.  
enum을 키로 사용할 수 있는 enumMap이 있다는걸 처음으로 알게 되었습니다.

## 검증  
프리코스를 진행함에 있어서 검증은 어디서 책임져야하나 그리고 Pattern은 어디서 생성해야하나 고민이 많았습니다.  
이번 프리코스 3주차에서 결론을 내렸는데 각자의 계층에서 담당해야 하는것만 담당하자 였습니다.  
예를들어 로또 객체를 만들때 생성자를 통해 값들을 주입받고 만드는 방식인데 이때 넘겨주는 값을 검증할 수 있는 부분은 크게 네곳입니다.  
컨트롤러에서 입력받을때(뷰), 서비스에게 값을 넘기기전에(컨트롤러), 서비스에서 객체 생성자에 넘겨줄때(서비스), 생성자를 통해 객체를 만들때(객체)  
저는 생성자를 통해 객체를 만들때(객체) 검증하는게 옳다고 생각하여 생성자안에서 호출되는 Lotto.validate쪽에서 로또번호의 제약조건을 검증하기로 했습니다.  
로또객체를 사용하는곳은 보통 서비스 계층인데 서비스 입장에서 이 로또 객체가 문제가 없는지 걱정할 필요 없이(로또 객체를 신회 할 수 있게) 사용할 수 있게 로또 번호에 대한 검증은 로또 객체가 담당하는게 맞다고 생각했습니다.  
컨트롤러는 정규식에 옳바르게 들어왔는지 -> 이중에 자연스레 번호가 총 6개인걸 검증하게 되겠지만 이건 서브적인 느낌이라 생각합니다. 결국 로또 객체를 만들때 객체자체가 한 번더 검증해야 한다 생각하고 이게 메인이라고 생각합니다.   
서비스는 입력값이 숫자로 파싱되는지,0이아닌지  
로또 객체는 1~45사이의 숫자들만 전달받았는지, 숫자 사이에 중복은 없는지 등  
각자가 담당해야 하는 부분만 검증하는게 맞다고 결론 내렸습니다.  




